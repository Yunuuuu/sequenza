\VignetteEngine{knitr::knitr}
\VignetteIndexEntry{Sequenza user guide}


# Abstract

Deep sequence of tumor DNA along with corresponding normal DNA can provide a
valuable perspective on the mutations and aberrations that characterize the
tumor. However, analysis of this data can be impeded by tumor cellularity and
heterogeneity and by unwieldy data. Here we describe *Sequenza*, an R package
that enables the efficient estimation of tumor cellularity and ploidy, and
generation of copy number, loss-of-heterozygosity, and mutation frequency
profiles. 

This document details a typical analysis of matched tumor-normal exome sequence
data using *sequenza*.

## Installation

The R package can be installed by:

```r
setRepositories(graphics = FALSE, ind = 1:6)
install.packages("sequenza")
```

To install the python companion package *sequenza-utils* to preprocess BAMM
file refers to the [project page](http://somehthing)


## Running sequenza

Load the package
```r
library(sequenza)
```
```{r echo=FALSE, message=FALSE}
library(sequenza)
data(CP.example)
CP <- CP.example
```
In the package is provided a preprocessed test *seqz* file

```{r}
data.file <-  system.file("data", "example.seqz.txt.gz", package = "sequenza")
data.file
```

The main interface consists in 3 functions:
  * sequenza.exctract: process seqz data, normalization and segmentation
  * sequenza.fit: run grid-search approach to estimate cellularity and ploidy
  * sequenza.results: write files and plot using suggested or selected solution

```r
test <- sequenza.extract(data.file)
CP <- sequenza.extract(test)
sequenza.results(sequenza.extract = test,
    cp.table = CP.example, sample.id = "Test",
    out.dir="TEST")
    
```

## Plots and Results

Some explanation of the results follows here


CP plot
```{r CPplot, echo=TRUE, fig.height=5, fig.width=5, fig.align='center'}
cp.plot(CP)
cp.plot.contours(CP, add = TRUE,
   likThresh = c(0.999, 0.95),
   col = c("lightsalmon", "red"), pch = 20)
```

chromosome view...
describe files in results folder
